(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var te,w,ze,K,Ie,Qe,Xe,Ze,ke,pe,me,en,ne={},nn=[],Nn=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,re=Array.isArray;function R(e,n){for(var r in n)e[r]=n[r];return e}function we(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function tn(e,n,r){var a,s,i,l={};for(i in n)i=="key"?a=n[i]:i=="ref"?s=n[i]:l[i]=n[i];if(arguments.length>2&&(l.children=arguments.length>3?te.call(arguments,2):r),typeof e=="function"&&e.defaultProps!=null)for(i in e.defaultProps)l[i]===void 0&&(l[i]=e.defaultProps[i]);return X(e,l,a,s,null)}function X(e,n,r,a,s){var i={type:e,props:n,key:r,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:s??++ze,__i:-1,__u:0};return s==null&&w.vnode!=null&&w.vnode(i),i}function V(e){return e.children}function Z(e,n){this.props=e,this.context=n}function Y(e,n){if(n==null)return e.__?Y(e.__,e.__i+1):null;for(var r;n<e.__k.length;n++)if((r=e.__k[n])!=null&&r.__e!=null)return r.__e;return typeof e.type=="function"?Y(e):null}function rn(e){var n,r;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,n=0;n<e.__k.length;n++)if((r=e.__k[n])!=null&&r.__e!=null){e.__e=e.__c.base=r.__e;break}return rn(e)}}function fe(e){(!e.__d&&(e.__d=!0)&&K.push(e)&&!ce.__r++||Ie!=w.debounceRendering)&&((Ie=w.debounceRendering)||Qe)(ce)}function ce(){for(var e,n,r,a,s,i,l,c=1;K.length;)K.length>c&&K.sort(Xe),e=K.shift(),c=K.length,e.__d&&(r=void 0,a=void 0,s=(a=(n=e).__v).__e,i=[],l=[],n.__P&&((r=R({},a)).__v=a.__v+1,w.vnode&&w.vnode(r),Ae(n.__P,r,a,n.__n,n.__P.namespaceURI,32&a.__u?[s]:null,i,s??Y(a),!!(32&a.__u),l),r.__v=a.__v,r.__.__k[r.__i]=r,on(i,r,l),a.__e=a.__=null,r.__e!=s&&rn(r)));ce.__r=0}function an(e,n,r,a,s,i,l,c,p,d,h){var o,_,m,g,k,v,b,f=a&&a.__k||nn,C=n.length;for(p=kn(r,n,f,p,C),o=0;o<C;o++)(m=r.__k[o])!=null&&(_=m.__i==-1?ne:f[m.__i]||ne,m.__i=o,v=Ae(e,m,_,s,i,l,c,p,d,h),g=m.__e,m.ref&&_.ref!=m.ref&&(_.ref&&Ce(_.ref,null,m),h.push(m.ref,m.__c||g,m)),k==null&&g!=null&&(k=g),(b=!!(4&m.__u))||_.__k===m.__k?p=sn(m,p,e,b):typeof m.type=="function"&&v!==void 0?p=v:g&&(p=g.nextSibling),m.__u&=-7);return r.__e=k,p}function kn(e,n,r,a,s){var i,l,c,p,d,h=r.length,o=h,_=0;for(e.__k=new Array(s),i=0;i<s;i++)(l=n[i])!=null&&typeof l!="boolean"&&typeof l!="function"?(p=i+_,(l=e.__k[i]=typeof l=="string"||typeof l=="number"||typeof l=="bigint"||l.constructor==String?X(null,l,null,null,null):re(l)?X(V,{children:l},null,null,null):l.constructor==null&&l.__b>0?X(l.type,l.props,l.key,l.ref?l.ref:null,l.__v):l).__=e,l.__b=e.__b+1,c=null,(d=l.__i=wn(l,r,p,o))!=-1&&(o--,(c=r[d])&&(c.__u|=2)),c==null||c.__v==null?(d==-1&&(s>h?_--:s<h&&_++),typeof l.type!="function"&&(l.__u|=4)):d!=p&&(d==p-1?_--:d==p+1?_++:(d>p?_--:_++,l.__u|=4))):e.__k[i]=null;if(o)for(i=0;i<h;i++)(c=r[i])!=null&&(2&c.__u)==0&&(c.__e==a&&(a=Y(c)),cn(c,c));return a}function sn(e,n,r,a){var s,i;if(typeof e.type=="function"){for(s=e.__k,i=0;s&&i<s.length;i++)s[i]&&(s[i].__=e,n=sn(s[i],n,r,a));return n}e.__e!=n&&(a&&(n&&e.type&&!n.parentNode&&(n=Y(e)),r.insertBefore(e.__e,n||null)),n=e.__e);do n=n&&n.nextSibling;while(n!=null&&n.nodeType==8);return n}function ge(e,n){return n=n||[],e==null||typeof e=="boolean"||(re(e)?e.some(function(r){ge(r,n)}):n.push(e)),n}function wn(e,n,r,a){var s,i,l,c=e.key,p=e.type,d=n[r],h=d!=null&&(2&d.__u)==0;if(d===null&&e.key==null||h&&c==d.key&&p==d.type)return r;if(a>(h?1:0)){for(s=r-1,i=r+1;s>=0||i<n.length;)if((d=n[l=s>=0?s--:i++])!=null&&(2&d.__u)==0&&c==d.key&&p==d.type)return l}return-1}function Me(e,n,r){n[0]=="-"?e.setProperty(n,r??""):e[n]=r==null?"":typeof r!="number"||Nn.test(n)?r:r+"px"}function se(e,n,r,a,s){var i,l;e:if(n=="style")if(typeof r=="string")e.style.cssText=r;else{if(typeof a=="string"&&(e.style.cssText=a=""),a)for(n in a)r&&n in r||Me(e.style,n,"");if(r)for(n in r)a&&r[n]==a[n]||Me(e.style,n,r[n])}else if(n[0]=="o"&&n[1]=="n")i=n!=(n=n.replace(Ze,"$1")),l=n.toLowerCase(),n=l in e||n=="onFocusOut"||n=="onFocusIn"?l.slice(2):n.slice(2),e.l||(e.l={}),e.l[n+i]=r,r?a?r.u=a.u:(r.u=ke,e.addEventListener(n,i?me:pe,i)):e.removeEventListener(n,i?me:pe,i);else{if(s=="http://www.w3.org/2000/svg")n=n.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(n!="width"&&n!="height"&&n!="href"&&n!="list"&&n!="form"&&n!="tabIndex"&&n!="download"&&n!="rowSpan"&&n!="colSpan"&&n!="role"&&n!="popover"&&n in e)try{e[n]=r??"";break e}catch{}typeof r=="function"||(r==null||r===!1&&n[4]!="-"?e.removeAttribute(n):e.setAttribute(n,n=="popover"&&r==1?"":r))}}function He(e){return function(n){if(this.l){var r=this.l[n.type+e];if(n.t==null)n.t=ke++;else if(n.t<r.u)return;return r(w.event?w.event(n):n)}}}function Ae(e,n,r,a,s,i,l,c,p,d){var h,o,_,m,g,k,v,b,f,C,S,N,U,H,E,F,G,I=n.type;if(n.constructor!=null)return null;128&r.__u&&(p=!!(32&r.__u),i=[c=n.__e=r.__e]),(h=w.__b)&&h(n);e:if(typeof I=="function")try{if(b=n.props,f="prototype"in I&&I.prototype.render,C=(h=I.contextType)&&a[h.__c],S=h?C?C.props.value:h.__:a,r.__c?v=(o=n.__c=r.__c).__=o.__E:(f?n.__c=o=new I(b,S):(n.__c=o=new Z(b,S),o.constructor=I,o.render=Cn),C&&C.sub(o),o.props=b,o.state||(o.state={}),o.context=S,o.__n=a,_=o.__d=!0,o.__h=[],o._sb=[]),f&&o.__s==null&&(o.__s=o.state),f&&I.getDerivedStateFromProps!=null&&(o.__s==o.state&&(o.__s=R({},o.__s)),R(o.__s,I.getDerivedStateFromProps(b,o.__s))),m=o.props,g=o.state,o.__v=n,_)f&&I.getDerivedStateFromProps==null&&o.componentWillMount!=null&&o.componentWillMount(),f&&o.componentDidMount!=null&&o.__h.push(o.componentDidMount);else{if(f&&I.getDerivedStateFromProps==null&&b!==m&&o.componentWillReceiveProps!=null&&o.componentWillReceiveProps(b,S),!o.__e&&o.shouldComponentUpdate!=null&&o.shouldComponentUpdate(b,o.__s,S)===!1||n.__v==r.__v){for(n.__v!=r.__v&&(o.props=b,o.state=o.__s,o.__d=!1),n.__e=r.__e,n.__k=r.__k,n.__k.some(function(O){O&&(O.__=n)}),N=0;N<o._sb.length;N++)o.__h.push(o._sb[N]);o._sb=[],o.__h.length&&l.push(o);break e}o.componentWillUpdate!=null&&o.componentWillUpdate(b,o.__s,S),f&&o.componentDidUpdate!=null&&o.__h.push(function(){o.componentDidUpdate(m,g,k)})}if(o.context=S,o.props=b,o.__P=e,o.__e=!1,U=w.__r,H=0,f){for(o.state=o.__s,o.__d=!1,U&&U(n),h=o.render(o.props,o.state,o.context),E=0;E<o._sb.length;E++)o.__h.push(o._sb[E]);o._sb=[]}else do o.__d=!1,U&&U(n),h=o.render(o.props,o.state,o.context),o.state=o.__s;while(o.__d&&++H<25);o.state=o.__s,o.getChildContext!=null&&(a=R(R({},a),o.getChildContext())),f&&!_&&o.getSnapshotBeforeUpdate!=null&&(k=o.getSnapshotBeforeUpdate(m,g)),F=h,h!=null&&h.type===V&&h.key==null&&(F=ln(h.props.children)),c=an(e,re(F)?F:[F],n,r,a,s,i,l,c,p,d),o.base=n.__e,n.__u&=-161,o.__h.length&&l.push(o),v&&(o.__E=o.__=null)}catch(O){if(n.__v=null,p||i!=null)if(O.then){for(n.__u|=p?160:128;c&&c.nodeType==8&&c.nextSibling;)c=c.nextSibling;i[i.indexOf(c)]=null,n.__e=c}else{for(G=i.length;G--;)we(i[G]);ve(n)}else n.__e=r.__e,n.__k=r.__k,O.then||ve(n);w.__e(O,n,r)}else i==null&&n.__v==r.__v?(n.__k=r.__k,n.__e=r.__e):c=n.__e=An(r.__e,n,r,a,s,i,l,p,d);return(h=w.diffed)&&h(n),128&n.__u?void 0:c}function ve(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(ve)}function on(e,n,r){for(var a=0;a<r.length;a++)Ce(r[a],r[++a],r[++a]);w.__c&&w.__c(n,e),e.some(function(s){try{e=s.__h,s.__h=[],e.some(function(i){i.call(s)})}catch(i){w.__e(i,s.__v)}})}function ln(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:re(e)?e.map(ln):R({},e)}function An(e,n,r,a,s,i,l,c,p){var d,h,o,_,m,g,k,v=r.props,b=n.props,f=n.type;if(f=="svg"?s="http://www.w3.org/2000/svg":f=="math"?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),i!=null){for(d=0;d<i.length;d++)if((m=i[d])&&"setAttribute"in m==!!f&&(f?m.localName==f:m.nodeType==3)){e=m,i[d]=null;break}}if(e==null){if(f==null)return document.createTextNode(b);e=document.createElementNS(s,f,b.is&&b),c&&(w.__m&&w.__m(n,i),c=!1),i=null}if(f==null)v===b||c&&e.data==b||(e.data=b);else{if(i=i&&te.call(e.childNodes),v=r.props||ne,!c&&i!=null)for(v={},d=0;d<e.attributes.length;d++)v[(m=e.attributes[d]).name]=m.value;for(d in v)if(m=v[d],d!="children"){if(d=="dangerouslySetInnerHTML")o=m;else if(!(d in b)){if(d=="value"&&"defaultValue"in b||d=="checked"&&"defaultChecked"in b)continue;se(e,d,null,m,s)}}for(d in b)m=b[d],d=="children"?_=m:d=="dangerouslySetInnerHTML"?h=m:d=="value"?g=m:d=="checked"?k=m:c&&typeof m!="function"||v[d]===m||se(e,d,m,v[d],s);if(h)c||o&&(h.__html==o.__html||h.__html==e.innerHTML)||(e.innerHTML=h.__html),n.__k=[];else if(o&&(e.innerHTML=""),an(n.type=="template"?e.content:e,re(_)?_:[_],n,r,a,f=="foreignObject"?"http://www.w3.org/1999/xhtml":s,i,l,i?i[0]:r.__k&&Y(r,0),c,p),i!=null)for(d=i.length;d--;)we(i[d]);c||(d="value",f=="progress"&&g==null?e.removeAttribute("value"):g!=null&&(g!==e[d]||f=="progress"&&!g||f=="option"&&g!=v[d])&&se(e,d,g,v[d],s),d="checked",k!=null&&k!=e[d]&&se(e,d,k,v[d],s))}return e}function Ce(e,n,r){try{if(typeof e=="function"){var a=typeof e.__u=="function";a&&e.__u(),a&&n==null||(e.__u=e(n))}else e.current=n}catch(s){w.__e(s,r)}}function cn(e,n,r){var a,s;if(w.unmount&&w.unmount(e),(a=e.ref)&&(a.current&&a.current!=e.__e||Ce(a,null,n)),(a=e.__c)!=null){if(a.componentWillUnmount)try{a.componentWillUnmount()}catch(i){w.__e(i,n)}a.base=a.__P=null}if(a=e.__k)for(s=0;s<a.length;s++)a[s]&&cn(a[s],n,r||typeof e.type!="function");r||we(e.__e),e.__c=e.__=e.__e=void 0}function Cn(e,n,r){return this.constructor(e,r)}function Pn(e,n,r){var a,s,i,l;n==document&&(n=document.documentElement),w.__&&w.__(e,n),s=(a=!1)?null:n.__k,i=[],l=[],Ae(n,e=n.__k=tn(V,null,[e]),s||ne,ne,n.namespaceURI,s?null:n.firstChild?te.call(n.childNodes):null,i,s?s.__e:n.firstChild,a,l),on(i,e,l)}function $n(e,n,r){var a,s,i,l,c=R({},e.props);for(i in e.type&&e.type.defaultProps&&(l=e.type.defaultProps),n)i=="key"?a=n[i]:i=="ref"?s=n[i]:c[i]=n[i]===void 0&&l!=null?l[i]:n[i];return arguments.length>2&&(c.children=arguments.length>3?te.call(arguments,2):r),X(e.type,c,a||e.key,s||e.ref,null)}function dn(e){function n(r){var a,s;return this.getChildContext||(a=new Set,(s={})[n.__c]=this,this.getChildContext=function(){return s},this.componentWillUnmount=function(){a=null},this.shouldComponentUpdate=function(i){this.props.value!=i.value&&a.forEach(function(l){l.__e=!0,fe(l)})},this.sub=function(i){a.add(i);var l=i.componentWillUnmount;i.componentWillUnmount=function(){a&&a.delete(i),l&&l.call(i)}}),r.children}return n.__c="__cC"+en++,n.__=e,n.Provider=n.__l=(n.Consumer=function(r,a){return r.children(a)}).contextType=n,n}te=nn.slice,w={__e:function(e,n,r,a){for(var s,i,l;n=n.__;)if((s=n.__c)&&!s.__)try{if((i=s.constructor)&&i.getDerivedStateFromError!=null&&(s.setState(i.getDerivedStateFromError(e)),l=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(e,a||{}),l=s.__d),l)return s.__E=s}catch(c){e=c}throw e}},ze=0,Z.prototype.setState=function(e,n){var r;r=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=R({},this.state),typeof e=="function"&&(e=e(R({},r),this.props)),e&&R(r,e),e!=null&&this.__v&&(n&&this._sb.push(n),fe(this))},Z.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),fe(this))},Z.prototype.render=V,K=[],Qe=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Xe=function(e,n){return e.__v.__b-n.__v.__b},ce.__r=0,Ze=/(PointerCapture)$|Capture$/i,ke=0,pe=He(!1),me=He(!0),en=0;var Tn=0;function t(e,n,r,a,s,i){n||(n={});var l,c,p=n;if("ref"in p)for(c in p={},n)c=="ref"?l=n[c]:p[c]=n[c];var d={type:e,props:p,key:r,ref:l,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Tn,__i:-1,__u:0,__source:s,__self:i};if(typeof e=="function"&&(l=e.defaultProps))for(c in l)p[c]===void 0&&(p[c]=l[c]);return w.vnode&&w.vnode(d),d}var z,P,_e,Oe,de=0,un=[],T=w,Re=T.__b,We=T.__r,Be=T.diffed,qe=T.__c,Ke=T.unmount,je=T.__;function ue(e,n){T.__h&&T.__h(P,e,de||n),de=0;var r=P.__H||(P.__H={__:[],__h:[]});return e>=r.__.length&&r.__.push({}),r.__[e]}function y(e){return de=1,Sn(_n,e)}function Sn(e,n,r){var a=ue(z++,2);if(a.t=e,!a.__c&&(a.__=[_n(void 0,n),function(c){var p=a.__N?a.__N[0]:a.__[0],d=a.t(p,c);p!==d&&(a.__N=[d,a.__[1]],a.__c.setState({}))}],a.__c=P,!P.__f)){var s=function(c,p,d){if(!a.__c.__H)return!0;var h=a.__c.__H.__.filter(function(_){return!!_.__c});if(h.every(function(_){return!_.__N}))return!i||i.call(this,c,p,d);var o=a.__c.props!==c;return h.forEach(function(_){if(_.__N){var m=_.__[0];_.__=_.__N,_.__N=void 0,m!==_.__[0]&&(o=!0)}}),i&&i.call(this,c,p,d)||o};P.__f=!0;var i=P.shouldComponentUpdate,l=P.componentWillUpdate;P.componentWillUpdate=function(c,p,d){if(this.__e){var h=i;i=void 0,s(c,p,d),i=h}l&&l.call(this,c,p,d)},P.shouldComponentUpdate=s}return a.__N||a.__}function J(e,n){var r=ue(z++,3);!T.__s&&hn(r.__H,n)&&(r.__=e,r.u=n,P.__H.__h.push(r))}function Un(e){return de=5,Fn(function(){return{current:e}},[])}function Fn(e,n){var r=ue(z++,7);return hn(r.__H,n)&&(r.__=e(),r.__H=n,r.__h=e),r.__}function xn(e){var n=P.context[e.__c],r=ue(z++,9);return r.c=e,n?(r.__==null&&(r.__=!0,n.sub(P)),n.props.value):e.__}function Dn(){for(var e;e=un.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(le),e.__H.__h.forEach(be),e.__H.__h=[]}catch(n){e.__H.__h=[],T.__e(n,e.__v)}}T.__b=function(e){P=null,Re&&Re(e)},T.__=function(e,n){e&&n.__k&&n.__k.__m&&(e.__m=n.__k.__m),je&&je(e,n)},T.__r=function(e){We&&We(e),z=0;var n=(P=e.__c).__H;n&&(_e===P?(n.__h=[],P.__h=[],n.__.forEach(function(r){r.__N&&(r.__=r.__N),r.u=r.__N=void 0})):(n.__h.forEach(le),n.__h.forEach(be),n.__h=[],z=0)),_e=P},T.diffed=function(e){Be&&Be(e);var n=e.__c;n&&n.__H&&(n.__H.__h.length&&(un.push(n)!==1&&Oe===T.requestAnimationFrame||((Oe=T.requestAnimationFrame)||En)(Dn)),n.__H.__.forEach(function(r){r.u&&(r.__H=r.u),r.u=void 0})),_e=P=null},T.__c=function(e,n){n.some(function(r){try{r.__h.forEach(le),r.__h=r.__h.filter(function(a){return!a.__||be(a)})}catch(a){n.some(function(s){s.__h&&(s.__h=[])}),n=[],T.__e(a,r.__v)}}),qe&&qe(e,n)},T.unmount=function(e){Ke&&Ke(e);var n,r=e.__c;r&&r.__H&&(r.__H.__.forEach(function(a){try{le(a)}catch(s){n=s}}),r.__H=void 0,n&&T.__e(n,r.__v))};var Ve=typeof requestAnimationFrame=="function";function En(e){var n,r=function(){clearTimeout(a),Ve&&cancelAnimationFrame(n),setTimeout(e)},a=setTimeout(r,35);Ve&&(n=requestAnimationFrame(r))}function le(e){var n=P,r=e.__c;typeof r=="function"&&(e.__c=void 0,r()),P=n}function be(e){var n=P;e.__c=e.__(),P=n}function hn(e,n){return!e||e.length!==n.length||n.some(function(r,a){return r!==e[a]})}function _n(e,n){return typeof n=="function"?n(e):n}var Ln={};function oe(e,n){for(var r in n)e[r]=n[r];return e}function In(e,n,r){var a,s=/(?:\?([^#]*))?(#.*)?$/,i=e.match(s),l={};if(i&&i[1])for(var c=i[1].split("&"),p=0;p<c.length;p++){var d=c[p].split("=");l[decodeURIComponent(d[0])]=decodeURIComponent(d.slice(1).join("="))}e=ye(e.replace(s,"")),n=ye(n||"");for(var h=Math.max(e.length,n.length),o=0;o<h;o++)if(n[o]&&n[o].charAt(0)===":"){var _=n[o].replace(/(^:|[+*?]+$)/g,""),m=(n[o].match(/[+*?]+$/)||Ln)[0]||"",g=~m.indexOf("+"),k=~m.indexOf("*"),v=e[o]||"";if(!v&&!k&&(m.indexOf("?")<0||g)){a=!1;break}if(l[_]=decodeURIComponent(v),g||k){l[_]=e.slice(o).map(decodeURIComponent).join("/");break}}else if(n[o]!==e[o]){a=!1;break}return(r.default===!0||a!==!1)&&l}function Mn(e,n){return e.rank<n.rank?1:e.rank>n.rank?-1:e.index-n.index}function Hn(e,n){return e.index=n,e.rank=(function(r){return r.props.default?0:ye(r.props.path).map(On).join("")})(e),e.props}function ye(e){return e.replace(/(^\/+|\/+$)/g,"").split("/")}function On(e){return e.charAt(0)==":"?1+"*+?".indexOf(e.charAt(e.length-1))||4:5}var Rn={},j=[],Je=[],M=null,pn={url:Pe()},Wn=dn(pn);function Pe(){var e;return""+((e=M&&M.location?M.location:M&&M.getCurrentLocation?M.getCurrentLocation():typeof location<"u"?location:Rn).pathname||"")+(e.search||"")}function L(e,n){return n===void 0&&(n=!1),typeof e!="string"&&e.url&&(n=e.replace,e=e.url),(function(r){for(var a=j.length;a--;)if(j[a].canRoute(r))return!0;return!1})(e)&&(function(r,a){a===void 0&&(a="push"),M&&M[a]?M[a](r):typeof history<"u"&&history[a+"State"]&&history[a+"State"](null,null,r)})(e,n?"replace":"push"),mn(e)}function mn(e){for(var n=!1,r=0;r<j.length;r++)j[r].routeTo(e)&&(n=!0);return n}function Bn(e){if(e&&e.getAttribute){var n=e.getAttribute("href"),r=e.getAttribute("target");if(n&&n.match(/^\//g)&&(!r||r.match(/^_?self$/i)))return L(n)}}function qn(e){return e.stopImmediatePropagation&&e.stopImmediatePropagation(),e.stopPropagation&&e.stopPropagation(),e.preventDefault(),!1}function Kn(e){if(!(e.ctrlKey||e.metaKey||e.altKey||e.shiftKey||e.button)){var n=e.target;do if(n.localName==="a"&&n.getAttribute("href")){if(n.hasAttribute("data-native")||n.hasAttribute("native"))return;if(Bn(n))return qn(e)}while(n=n.parentNode)}}var Ge=!1;function fn(e){e.history&&(M=e.history),this.state={url:e.url||Pe()}}oe(fn.prototype=new Z,{shouldComponentUpdate:function(e){return e.static!==!0||e.url!==this.props.url||e.onChange!==this.props.onChange},canRoute:function(e){var n=ge(this.props.children);return this.g(n,e)!==void 0},routeTo:function(e){this.setState({url:e});var n=this.canRoute(e);return this.p||this.forceUpdate(),n},componentWillMount:function(){this.p=!0},componentDidMount:function(){var e=this;Ge||(Ge=!0,M||addEventListener("popstate",function(){mn(Pe())}),addEventListener("click",Kn)),j.push(this),M&&(this.u=M.listen(function(n){var r=n.location||n;e.routeTo(""+(r.pathname||"")+(r.search||""))})),this.p=!1},componentWillUnmount:function(){typeof this.u=="function"&&this.u(),j.splice(j.indexOf(this),1)},componentWillUpdate:function(){this.p=!0},componentDidUpdate:function(){this.p=!1},g:function(e,n){e=e.filter(Hn).sort(Mn);for(var r=0;r<e.length;r++){var a=e[r],s=In(n,a.props.path,a.props);if(s)return[a,s]}},render:function(e,n){var r,a,s=e.onChange,i=n.url,l=this.c,c=this.g(ge(e.children),i);if(c&&(a=$n(c[0],oe(oe({url:i,matches:r=c[1]},r),{key:void 0,ref:void 0}))),i!==(l&&l.url)){oe(pn,l=this.c={url:i,previous:l&&l.url,current:a,path:a?a.props.path:null,matches:r}),l.router=this,l.active=a?[a]:[];for(var p=Je.length;p--;)Je[p]({});typeof s=="function"&&s(l)}return tn(Wn.Provider,{value:l},a)}});let gn="/api";function Ye(e){gn=e}class jn extends Error{constructor(n,r,a){super(n),this.status=r,this.detail=a,this.name="APIError"}}async function he(e,n={}){const r=`${gn}${e}`,a=await fetch(r,{...n,credentials:"include",headers:{"Content-Type":"application/json",...n.headers}});if(!a.ok){const s=await a.json().catch(()=>({detail:"Unknown error"}));throw new jn(s.detail||`HTTP ${a.status}`,a.status,s)}return a.status===204?null:a.json()}function W(e){return he(e,{method:"GET"})}function D(e,n){return he(e,{method:"POST",body:n?JSON.stringify(n):void 0})}function Vn(e,n){return he(e,{method:"PUT",body:n?JSON.stringify(n):void 0})}function Jn(e){return he(e,{method:"DELETE"})}const Gn={health:()=>W("/health"),config:()=>W("/auth/config"),me:()=>W("/auth/me"),registerBegin:e=>D("/auth/webauthn/register/begin",e),registerFinish:e=>D("/auth/webauthn/register/finish",e),loginBegin:e=>D("/auth/webauthn/login/begin",e),loginFinish:e=>D("/auth/webauthn/login/finish",e),bootstrapLogin:e=>D("/auth/token/bootstrap",{token:e}),logout:()=>D("/auth/logout")},Yn={getProfile:()=>W("/users/me"),updateProfile:e=>Vn("/users/me",e),getAuthMethods:()=>W("/users/me/auth-methods"),deleteAuthMethod:e=>Jn(`/users/me/auth-methods/${e}`),addPasswordAuth:(e,n)=>D("/users/me/auth-methods/password",{password:e,identifier:n}),beginAddPasskey:e=>D("/users/me/auth-methods/passkey/begin",e),finishAddPasskey:e=>D("/users/me/auth-methods/passkey/finish",e),createApiToken:(e,n)=>D("/users/me/auth-methods/token/create",{description:e,expires_in_days:n})},zn={createToken:e=>D("/m2m/token/create",e||{}),refreshToken:e=>D("/m2m/token/refresh",{refresh_token:e}),validateToken:e=>D("/m2m/token/validate",{token:e})},Qn={listUsers:e=>{const n=new URLSearchParams;e!=null&&e.enabled_only&&n.append("enabled_only","true"),(e==null?void 0:e.offset)!==void 0&&n.append("offset",e.offset.toString()),(e==null?void 0:e.limit)!==void 0&&n.append("limit",e.limit.toString());const r=n.toString();return W(`/admin/users${r?`?${r}`:""}`)},getUser:e=>W(`/admin/users/${e}`),toggleUser:(e,n)=>D(`/admin/users/${e}/toggle`,{enabled:n}),getUserAuthMethods:e=>W(`/admin/users/${e}/auth-methods`),approveAuthMethod:(e,n)=>D(`/admin/auth-methods/${e}/approve`,{approved:n}),toggleAuthMethod:(e,n)=>D(`/admin/auth-methods/${e}/toggle`,{enabled:n}),getPendingApprovals:()=>W("/admin/auth-methods/pending")},$={auth:Gn,user:Yn,m2m:zn,admin:Qn};function q(e){const n=new Uint8Array(e);let r="";for(let s=0;s<n.byteLength;s++)r+=String.fromCharCode(n[s]);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function ee(e){let n=e.replace(/-/g,"+").replace(/_/g,"/");for(;n.length%4;)n+="=";const r=atob(n),a=new Uint8Array(r.length);for(let s=0;s<r.length;s++)a[s]=r.charCodeAt(s);return a.buffer}async function vn(e){var s;const n={challenge:ee(e.challenge),rp:{id:e.rp.id,name:e.rp.name},user:{id:ee(e.user.id),name:e.user.name,displayName:e.user.displayName},pubKeyCredParams:e.pubKeyCredParams,timeout:e.timeout||6e4,attestation:e.attestation||"none",authenticatorSelection:e.authenticatorSelection||{authenticatorAttachment:"platform",residentKey:"preferred",userVerification:"preferred"},excludeCredentials:(s=e.excludeCredentials)==null?void 0:s.map(i=>({id:ee(i.id),type:"public-key",transports:i.transports}))},r=await navigator.credentials.create({publicKey:n});if(!r)throw new Error("Failed to create credential");const a=r.response;return{id:r.id,rawId:q(r.rawId),response:{clientDataJSON:q(a.clientDataJSON),attestationObject:q(a.attestationObject),transports:a.getTransports?a.getTransports():void 0},type:"public-key"}}async function Xn(e){var s;const n={challenge:ee(e.challenge),rpId:e.rpId,timeout:e.timeout||6e4,userVerification:e.userVerification||"preferred",allowCredentials:(s=e.allowCredentials)==null?void 0:s.map(i=>({id:ee(i.id),type:"public-key",transports:i.transports}))},r=await navigator.credentials.get({publicKey:n});if(!r)throw new Error("Failed to get credential");const a=r.response;return{id:r.id,rawId:q(r.rawId),response:{clientDataJSON:q(a.clientDataJSON),authenticatorData:q(a.authenticatorData),signature:q(a.signature),userHandle:a.userHandle?q(a.userHandle):null},type:"public-key"}}function $e(){return!!(typeof window<"u"&&typeof window.PublicKeyCredential<"u"&&navigator.credentials&&typeof navigator.credentials.create<"u"&&typeof navigator.credentials.get<"u")}async function Zn(){if(!$e())return!1;try{return typeof PublicKeyCredential<"u"&&typeof PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable=="function"?await PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable():!1}catch{return!1}}let B=null;async function et(){if(B)return B;try{const e=await fetch("/config.json");if(!e.ok)throw new Error("Failed to load config");return B=await e.json(),B}catch(e){return console.error("Failed to load config, using defaults:",e),B={api_base_url:"/api",allowed_rps:[{rp_id:"localhost",rp_name:"Local Development",origins:["http://localhost:8000","http://localhost:3000"]}],require_auth_method_approval:!1,allow_self_service_auth:!0},B}}function Ne(){if(!B)throw new Error("Config not loaded. Call loadConfig() first.");return B}const bn=dn(null);function nt({children:e}){const[n,r]=y(null),[a,s]=y(!0);J(()=>{i()},[]);const i=async()=>{try{const o=await $.auth.me();r(o.user)}catch{r(null)}finally{s(!1)}},l=async o=>{try{const m=Ne().allowed_rps[0],g=window.location.origin;console.log("[AUTH] Starting registration for:",o.email);const{options:k,user_id:v}=await $.auth.registerBegin({rp_id:m.rp_id,origin:g,display_name:o.first_name||o.nick,username_hint:o.email||o.nick});console.log("[AUTH] Got challenge, user_id:",v,"challenge:",k.challenge.substring(0,20)+"..."),console.log("[AUTH] Creating WebAuthn credential...");const b=await vn(k);console.log("[AUTH] Credential created, id:",b.id),console.log("[AUTH] Finishing registration...");const f=await $.auth.registerFinish({rp_id:m.rp_id,origin:g,user_id:v,credential:b,name:o.first_name,email:o.email});console.log("[AUTH] Registration complete!"),r(f.user)}catch(_){throw console.error("Registration failed:",_),_}},c=async o=>{try{const m=Ne().allowed_rps[0],g=window.location.origin,{options:k}=await $.auth.loginBegin({rp_id:m.rp_id,origin:g,email:o}),v=await Xn(k),b=await $.auth.loginFinish({rp_id:m.rp_id,origin:g,credential:v});r(b.user)}catch(_){throw console.error("Login failed:",_),_}},p=async o=>{try{const _=await $.auth.bootstrapLogin(o);r(_.user)}catch(_){throw console.error("Bootstrap login failed:",_),_}},d=async()=>{try{await $.auth.logout()}catch(o){console.error("Logout failed:",o)}finally{r(null)}},h={user:n,isAuthenticated:!!n,isAdmin:(n==null?void 0:n.is_admin)??!1,isLoading:a,login:c,register:l,bootstrapLogin:p,logout:d,refreshUser:i};return t(bn.Provider,{value:h,children:e})}function ae(){const e=xn(bn);if(!e)throw new Error("useAuth must be used within AuthProvider");return e}function Te(){const[e,n]=y(null),r="1.0.0";return J(()=>{(async()=>{try{const s=await $.auth.health();n(s)}catch(s){console.error("Failed to fetch version:",s)}})()},[]),e?t("div",{className:"version-info",children:[t("div",{className:"version-item",children:[t("span",{className:"version-label",children:"Backend:"}),t("span",{className:"version-value",children:["v",e.version,e.git_commit!=="unknown"&&t("span",{className:"version-commit",title:`Branch: ${e.git_branch}`,children:[" ","(",e.git_commit,")"]})]})]}),t("div",{className:"version-item",children:[t("span",{className:"version-label",children:"Frontend:"}),t("span",{className:"version-value",children:["v",r]})]}),e.build_date&&t("div",{className:"version-item",children:[t("span",{className:"version-label",children:"Built:"}),t("span",{className:"version-value",children:e.build_date})]})]}):t("div",{className:"version-info",children:t("div",{className:"version-item",children:[t("span",{className:"version-label",children:"Frontend:"}),t("span",{className:"version-value",children:["v",r]})]})})}function tt(e){const{isAuthenticated:n}=ae();return J(()=>{n&&L("/dashboard")},[n]),t("div",{className:"home-container",children:[t("div",{className:"hero",children:[t("h1",{children:"ðŸ” HOA"}),t("p",{className:"tagline",children:"Heavily Over-engineered Authentication"}),t("p",{className:"subtitle",children:"Passwordless authentication with WebAuthn/Passkeys"}),t("div",{className:"cta-buttons",children:[t("button",{className:"btn btn-primary btn-large",onClick:()=>L("/login"),children:"Sign In"}),t("button",{className:"btn btn-secondary btn-large",onClick:()=>L("/register"),children:"Create Account"})]})]}),t("div",{className:"features",children:[t("div",{className:"feature",children:[t("h3",{children:"ðŸ”’ Secure"}),t("p",{children:"Phishing-resistant authentication using FIDO2/WebAuthn standards"})]}),t("div",{className:"feature",children:[t("h3",{children:"ðŸš€ Fast"}),t("p",{children:"One-click login with Touch ID, Windows Hello, or security keys"})]}),t("div",{className:"feature",children:[t("h3",{children:"ðŸŽ¯ Simple"}),t("p",{children:"No passwords to remember, no SMS codes, no email verification"})]})]}),t("div",{style:{marginTop:"3rem"},children:t(Te,{})})]})}function rt(e){const{login:n,bootstrapLogin:r}=ae(),[a,s]=y(""),[i,l]=y(""),[c,p]=y(!1),[d,h]=y(null),[o,_]=y(!1),[m,g]=y(!0),[k,v]=y(!1);return y(()=>{g($e()),Zn().then(v)}),t("div",{className:"login-container",children:t("div",{className:"login-card",children:[t("h1",{children:"Sign In to HOA"}),!m&&t("div",{className:"warning",children:"âš ï¸ WebAuthn is not supported in this browser. Please use a modern browser."}),c?t("form",{onSubmit:async C=>{if(C.preventDefault(),!i.trim()){h("Please enter admin token");return}h(null),_(!0);try{await r(i),L("/dashboard")}catch(S){console.error("Admin login error:",S),h(S.message||"Invalid admin token")}finally{_(!1)}},children:[t("div",{className:"form-group",children:[t("label",{htmlFor:"token",children:"Admin Token"}),t("input",{id:"token",type:"password",value:i,onInput:C=>l(C.target.value),placeholder:"Enter bootstrap token",disabled:o,autoFocus:!0}),t("small",{children:["This token is generated on first startup and stored in"," ",t("code",{children:"~/.config/hoa/admin.txt"})]})]}),d&&t("div",{className:"error",children:d}),t("button",{type:"submit",className:"btn btn-primary",disabled:o,children:o?"Signing in...":"Sign in with Token"}),t("button",{type:"button",className:"btn btn-secondary",onClick:()=>{p(!1),h(null)},disabled:o,children:"â† Back to Passkey Login"})]}):t("form",{onSubmit:async C=>{if(C.preventDefault(),!a.trim()){h("Please enter your email or username");return}h(null),_(!0);try{await n(a),L("/dashboard")}catch(S){console.error("Login error:",S),h(S.message||"Login failed. Please try again.")}finally{_(!1)}},children:[t("div",{className:"form-group",children:[t("label",{htmlFor:"identifier",children:"Email or Username"}),t("input",{id:"identifier",type:"text",value:a,onInput:C=>s(C.target.value),placeholder:"you@example.com",disabled:o||!m,autoFocus:!0})]}),d&&t("div",{className:"error",children:d}),t("button",{type:"submit",className:"btn btn-primary",disabled:o||!m,children:o?"Signing in...":"ðŸ” Sign in with Passkey"}),k&&t("div",{className:"hint",children:["âœ¨ Use your ",navigator.platform.includes("Mac")?"Touch ID":"Windows Hello"," to sign in"]}),t("div",{className:"divider",children:"or"}),t("button",{type:"button",className:"btn btn-secondary",onClick:()=>p(!0),disabled:o,children:"Use Admin Token"}),t("div",{className:"footer-links",children:["Don't have an account? ",t("a",{href:"/register",children:"Register"})]})]})]})})}function at(e){const{register:n}=ae(),[r,a]=y({nick:"",email:"",first_name:"",second_name:"",phone_number:""}),[s,i]=y(null),[l,c]=y(!1),[p]=y($e()),d=Un(!1),h=(_,m)=>{a(g=>({...g,[_]:m}))};return t("div",{className:"register-container",children:t("div",{className:"register-card",children:[t("h1",{children:"Create Account"}),t("p",{className:"subtitle",children:"Join HOA with passwordless authentication"}),!p&&t("div",{className:"warning",children:"âš ï¸ WebAuthn is not supported in this browser. Please use a modern browser."}),t("form",{onSubmit:async _=>{var g,k,v,b;if(_.preventDefault(),d.current){console.log("[DEBUG] Preventing duplicate submission");return}if(!r.nick.trim()){i("Username is required");return}if(!((g=r.email)!=null&&g.trim())){i("Email is required");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.email)){i("Please enter a valid email address");return}i(null),c(!0),d.current=!0;try{await n({nick:r.nick,email:r.email,first_name:r.first_name||void 0,second_name:r.second_name||void 0,phone_number:r.phone_number||void 0}),L("/dashboard")}catch(f){console.error("Registration error:",f),(k=f.message)!=null&&k.includes("already exists")?i("A user with this email already exists"):(v=f.message)!=null&&v.includes("canceled")?i("Passkey creation was canceled. Please try again."):(b=f.message)!=null&&b.includes("NotAllowedError")?i("Unable to create passkey. Please check your authenticator."):i(f.message||"Registration failed. Please try again.")}finally{c(!1),d.current=!1}},children:[t("div",{className:"form-group",children:[t("label",{htmlFor:"nick",children:"Username *"}),t("input",{id:"nick",type:"text",value:r.nick,onInput:_=>h("nick",_.target.value),placeholder:"johndoe",disabled:l||!p,required:!0,autoFocus:!0})]}),t("div",{className:"form-group",children:[t("label",{htmlFor:"email",children:"Email *"}),t("input",{id:"email",type:"email",value:r.email,onInput:_=>h("email",_.target.value),placeholder:"john@example.com",disabled:l||!p,required:!0})]}),t("div",{className:"form-row",children:[t("div",{className:"form-group",children:[t("label",{htmlFor:"first_name",children:"First Name"}),t("input",{id:"first_name",type:"text",value:r.first_name,onInput:_=>h("first_name",_.target.value),placeholder:"John",disabled:l||!p})]}),t("div",{className:"form-group",children:[t("label",{htmlFor:"second_name",children:"Last Name"}),t("input",{id:"second_name",type:"text",value:r.second_name,onInput:_=>h("second_name",_.target.value),placeholder:"Doe",disabled:l||!p})]})]}),t("div",{className:"form-group",children:[t("label",{htmlFor:"phone_number",children:"Phone Number"}),t("input",{id:"phone_number",type:"tel",value:r.phone_number,onInput:_=>h("phone_number",_.target.value),placeholder:"+1 (555) 123-4567",disabled:l||!p})]}),s&&t("div",{className:"error",children:s}),t("div",{className:"info",children:"â„¹ï¸ After submitting, you'll be prompted to create a passkey using your device's authenticator (Touch ID, Windows Hello, or security key)."}),t("button",{type:"submit",className:"btn btn-primary",disabled:l||!p,children:l?"Creating account...":"ðŸ” Create Account & Passkey"}),t("div",{className:"footer-links",children:["Already have an account? ",t("a",{href:"/login",children:"Sign in"})]})]})]})})}function it({onClose:e,onSuccess:n}){const[r,a]=y(null),[s,i]=y(!1),[l,c]=y(null),[p,d]=y(""),[h,o]=y(""),[_,m]=y(""),[g,k]=y("30"),[v,b]=y(null);return t("div",{className:"modal-overlay",onClick:e,children:t("div",{className:"modal-content",onClick:N=>N.stopPropagation(),children:[t("div",{className:"modal-header",children:[t("h2",{children:"Add Authentication Method"}),t("button",{className:"close-btn",onClick:e,children:"Ã—"})]}),t("div",{className:"modal-body",children:r?r==="password"?t("div",{className:"auth-method-form",children:[t("button",{className:"btn btn-link",onClick:()=>a(null),children:"â† Back"}),t("h3",{children:"Add Password"}),t("div",{className:"form-group",children:[t("label",{htmlFor:"password",children:"Password *"}),t("input",{id:"password",type:"password",value:p,onInput:N=>d(N.target.value),placeholder:"Enter password (min 8 characters)",disabled:s,required:!0})]}),t("div",{className:"form-group",children:[t("label",{htmlFor:"confirmPassword",children:"Confirm Password *"}),t("input",{id:"confirmPassword",type:"password",value:h,onInput:N=>o(N.target.value),placeholder:"Confirm password",disabled:s,required:!0})]}),l&&t("div",{className:"error",children:l}),t("div",{className:"modal-footer",children:[t("button",{className:"btn btn-secondary",onClick:e,disabled:s,children:"Cancel"}),t("button",{className:"btn btn-primary",onClick:async()=>{if(c(null),p.length<8){c("Password must be at least 8 characters long");return}if(p!==h){c("Passwords do not match");return}i(!0);try{await $.user.addPasswordAuth(p),n(),e()}catch(N){console.error("Failed to add password:",N),c(N.message||"Failed to add password authentication")}finally{i(!1)}},disabled:s||!p||!h,children:s?"Adding...":"Add Password"})]})]}):r==="token"?t("div",{className:"auth-method-form",children:[t("button",{className:"btn btn-link",onClick:()=>{a(null),b(null)},children:"â† Back"}),v?t(V,{children:[t("h3",{children:"âœ… Token Created Successfully!"}),t("div",{className:"warning",children:[t("strong",{children:"âš ï¸ Important:"})," Copy these tokens now. You won't be able to see them again!"]}),t("div",{className:"form-group",children:[t("label",{htmlFor:"accessToken",children:"Access Token"}),t("textarea",{id:"accessToken",value:v.access_token,readOnly:!0,rows:4,onClick:N=>N.target.select()}),t("button",{className:"btn btn-sm btn-secondary",onClick:()=>{navigator.clipboard.writeText(v.access_token),alert("Access token copied to clipboard!")},children:"ðŸ“‹ Copy Access Token"})]}),t("div",{className:"form-group",children:[t("label",{htmlFor:"refreshToken",children:"Refresh Token"}),t("textarea",{id:"refreshToken",value:v.refresh_token,readOnly:!0,rows:4,onClick:N=>N.target.select()}),t("button",{className:"btn btn-sm btn-secondary",onClick:()=>{navigator.clipboard.writeText(v.refresh_token),alert("Refresh token copied to clipboard!")},children:"ðŸ“‹ Copy Refresh Token"})]}),t("div",{className:"info",children:[t("p",{children:[t("strong",{children:"Expires:"})," ",new Date(v.expires_at).toLocaleString()]}),t("p",{children:[t("strong",{children:"Usage:"})," Include the access token in your API requests:"]}),t("code",{children:"Authorization: Bearer YOUR_ACCESS_TOKEN"})]}),t("div",{className:"modal-footer",children:t("button",{className:"btn btn-primary",onClick:e,children:"Done"})})]}):t(V,{children:[t("h3",{children:"Create API Token"}),t("p",{children:"Create a JWT token for API access. This token can be used for automation and programmatic access to your account."}),t("div",{className:"form-group",children:[t("label",{htmlFor:"tokenDescription",children:"Description *"}),t("input",{id:"tokenDescription",type:"text",value:_,onInput:N=>m(N.target.value),placeholder:"e.g., CI/CD Pipeline, Mobile App, etc.",disabled:s,required:!0})]}),t("div",{className:"form-group",children:[t("label",{htmlFor:"tokenExpireDays",children:"Expires in (days) *"}),t("input",{id:"tokenExpireDays",type:"number",min:"1",max:"365",value:g,onInput:N=>k(N.target.value),disabled:s,required:!0}),t("small",{className:"form-hint",children:["Token will expire in ",g," days (max 365)"]})]}),l&&t("div",{className:"error",children:l}),t("div",{className:"modal-footer",children:[t("button",{className:"btn btn-secondary",onClick:e,disabled:s,children:"Cancel"}),t("button",{className:"btn btn-primary",onClick:async()=>{if(c(null),_.trim().length<3){c("Description must be at least 3 characters long");return}const N=parseInt(g);if(isNaN(N)||N<1||N>365){c("Expiration must be between 1 and 365 days");return}i(!0);try{const U=await $.user.createApiToken(_,N);b({access_token:U.access_token,refresh_token:U.refresh_token,expires_at:U.expires_at}),n()}catch(U){console.error("Failed to create token:",U),c(U.message||"Failed to create API token")}finally{i(!1)}},disabled:s||!_.trim(),children:s?"Creating...":"ðŸŽ« Create Token"})]})]})]}):t("div",{className:"auth-method-form",children:[t("button",{className:"btn btn-link",onClick:()=>a(null),children:"â† Back"}),t("h3",{children:"Add Passkey"}),t("p",{children:"Click the button below to create a new passkey using your device's authenticator (Touch ID, Windows Hello, or security key)."}),l&&t("div",{className:"error",children:l}),t("div",{className:"modal-footer",children:[t("button",{className:"btn btn-secondary",onClick:e,disabled:s,children:"Cancel"}),t("button",{className:"btn btn-primary",onClick:async()=>{c(null),i(!0);try{const U=Ne().allowed_rps[0],H=window.location.origin,{options:E}=await $.user.beginAddPasskey({rp_id:U.rp_id,origin:H,display_name:"Additional Passkey"}),F=await vn(E);await $.user.finishAddPasskey({rp_id:U.rp_id,origin:H,credential:F}),n(),e()}catch(N){console.error("Failed to add passkey:",N),N.name==="NotAllowedError"?c("Passkey creation was cancelled"):c(N.message||"Failed to add passkey")}finally{i(!1)}},disabled:s,children:s?"Creating passkey...":"ðŸ” Create Passkey"})]})]}):t("div",{className:"auth-method-selection",children:[t("p",{children:"Choose an authentication method to add:"}),t("button",{className:"auth-method-option",onClick:()=>a("passkey"),children:[t("span",{className:"option-icon",children:"ðŸ”"}),t("div",{className:"option-details",children:[t("strong",{children:"Passkey"}),t("p",{children:"Use Touch ID, Windows Hello, or a security key"})]})]}),t("button",{className:"auth-method-option",onClick:()=>a("password"),children:[t("span",{className:"option-icon",children:"ðŸ”‘"}),t("div",{className:"option-details",children:[t("strong",{children:"Password"}),t("p",{children:"Traditional password authentication"})]})]}),t("button",{className:"auth-method-option",onClick:()=>a("token"),children:[t("span",{className:"option-icon",children:"ðŸŽ«"}),t("div",{className:"option-details",children:[t("strong",{children:"API Token"}),t("p",{children:"JWT token for API access and automation"})]})]})]})})]})})}function st(e){const{user:n,isAuthenticated:r,isAdmin:a,logout:s}=ae(),[i,l]=y([]),[c,p]=y(!0),[d,h]=y(null),[o,_]=y(!1);J(()=>{r||L("/login")},[r]),J(()=>{r&&m()},[r]);const m=async()=>{try{p(!0);const f=await $.user.getAuthMethods();l(f)}catch(f){console.error("Failed to load auth methods:",f),h("Failed to load authentication methods")}finally{p(!1)}},g=async f=>{if(confirm("Are you sure you want to delete this authentication method?"))try{await $.user.deleteAuthMethod(f),await m()}catch(C){console.error("Failed to delete auth method:",C),alert(C.message||"Failed to delete authentication method")}},k=async()=>{await s(),L("/login")};if(!n)return null;const v=f=>{switch(f){case"passkey":return"ðŸ”";case"password":return"ðŸ”‘";case"oauth2":return"ðŸŒ";case"token":return"ðŸŽ«";default:return"â“"}},b=f=>{switch(f.type){case"passkey":return`Passkey (${f.identifier||f.id.substring(0,8)})`;case"password":return`Password (${f.identifier||"primary"})`;case"oauth2":return`OAuth2 - ${f.provider}`;case"token":return`Token - ${f.description}`;default:return"Unknown method"}};return t("div",{className:"dashboard-container",children:[t("div",{className:"dashboard-header",children:[t("h1",{children:"Dashboard"}),t("button",{className:"btn btn-secondary",onClick:k,children:"Logout"})]}),t("div",{className:"card",children:[t("h2",{children:"Profile"}),t("div",{className:"profile-info",children:[t("div",{className:"info-row",children:[t("span",{className:"label",children:"Username:"}),t("span",{className:"value",children:n.nick||"(not set)"})]}),n.email&&t("div",{className:"info-row",children:[t("span",{className:"label",children:"Email:"}),t("span",{className:"value",children:n.email})]}),n.first_name&&t("div",{className:"info-row",children:[t("span",{className:"label",children:"First Name:"}),t("span",{className:"value",children:n.first_name})]}),n.second_name&&t("div",{className:"info-row",children:[t("span",{className:"label",children:"Last Name:"}),t("span",{className:"value",children:n.second_name})]}),n.phone_number&&t("div",{className:"info-row",children:[t("span",{className:"label",children:"Phone:"}),t("span",{className:"value",children:n.phone_number})]}),t("div",{className:"info-row",children:[t("span",{className:"label",children:"Status:"}),t("span",{className:`badge ${n.enabled?"badge-success":"badge-danger"}`,children:n.enabled?"Active":"Disabled"})]}),a&&t("div",{className:"info-row",children:[t("span",{className:"label",children:"Role:"}),t("span",{className:"badge badge-primary",children:"Administrator"})]}),t("div",{className:"info-row",children:[t("span",{className:"label",children:"Member since:"}),t("span",{className:"value",children:new Date(n.created_at).toLocaleDateString()})]})]}),t("button",{className:"btn btn-secondary",onClick:()=>alert("Edit profile coming soon!"),children:"Edit Profile"})]}),t("div",{className:"card",children:[t("h2",{children:"Authentication Methods"}),c?t("div",{className:"loading",children:"Loading authentication methods..."}):d?t("div",{className:"error",children:d}):t(V,{children:[t("div",{className:"auth-methods-list",children:i.map(f=>t("div",{className:"auth-method-item",children:[t("div",{className:"method-info",children:[t("span",{className:"method-icon",children:v(f.type)}),t("div",{className:"method-details",children:[t("div",{className:"method-label",children:b(f)}),t("div",{className:"method-meta",children:[!f.enabled&&t("span",{className:"badge badge-danger",children:"Disabled"}),f.requires_approval&&!f.approved&&t("span",{className:"badge badge-warning",children:"Pending Approval"}),t("span",{className:"method-created",children:["Added ",new Date(f.created_at).toLocaleDateString()]})]})]})]}),t("div",{className:"method-actions",children:i.length>1&&t("button",{className:"btn btn-danger btn-sm",onClick:()=>g(f.id),children:"Delete"})})]},f.id))}),i.length===0&&t("div",{className:"empty-state",children:"No authentication methods configured"})]}),t("button",{className:"btn btn-primary",onClick:()=>_(!0),children:"+ Add Authentication Method"})]}),a&&t("div",{className:"card",children:[t("h2",{children:"Administration"}),t("p",{children:"You have administrative privileges."}),t("button",{className:"btn btn-primary",onClick:()=>L("/admin"),children:"Go to Admin Panel"})]}),t("div",{style:{marginTop:"2rem"},children:t(Te,{})}),o&&t(it,{onClose:()=>_(!1),onSuccess:()=>{m()}})]})}function ot(e){const{user:n,isAuthenticated:r,isAdmin:a}=ae(),[s,i]=y("users"),[l,c]=y([]),[p,d]=y([]),[h,o]=y(null),[_,m]=y([]),[g,k]=y(null),[v,b]=y(null),[f,C]=y(""),[S,N]=y(!0),[U,H]=y(null),[E,F]=y(null);J(()=>{r?a||L("/dashboard"):L("/login")},[r,a]),J(()=>{r&&a&&(s==="users"?G():I())},[r,a,s,g,v]);const G=async()=>{try{N(!0),H(null);let A=await $.admin.listUsers();if(g!==null&&(A=A.filter(x=>x.enabled===g)),v!==null&&(A=A.filter(x=>x.is_admin===v)),f){const x=f.toLowerCase();A=A.filter(ie=>{var xe,De,Ee,Le;return((xe=ie.nick)==null?void 0:xe.toLowerCase().includes(x))||((De=ie.email)==null?void 0:De.toLowerCase().includes(x))||((Ee=ie.first_name)==null?void 0:Ee.toLowerCase().includes(x))||((Le=ie.second_name)==null?void 0:Le.toLowerCase().includes(x))})}c(A)}catch(u){console.error("Failed to load users:",u),H(u.message||"Failed to load users")}finally{N(!1)}},I=async()=>{try{N(!0),H(null);const u=await $.admin.getPendingApprovals();d(u)}catch(u){console.error("Failed to load pending approvals:",u),H(u.message||"Failed to load pending approvals")}finally{N(!1)}},O=async u=>{try{F("user-details");const A=await $.admin.getUser(u),x=await $.admin.getUserAuthMethods(u);o(A),m(x)}catch(A){console.error("Failed to load user details:",A),alert(`Failed to load user details: ${A.message}`)}finally{F(null)}},yn=async(u,A)=>{if(confirm("Are you sure you want to toggle this user's enabled status?"))try{F(`toggle-user-${u}`),await $.admin.toggleUser(u,!A),await G(),(h==null?void 0:h.id)===u&&await O(u)}catch(x){console.error("Failed to toggle user:",x),alert(`Failed to toggle user: ${x.message}`)}finally{F(null)}},Se=async u=>{try{F(`approve-${u}`),await $.admin.approveAuthMethod(u,!0),await I(),h&&await O(h.id)}catch(A){console.error("Failed to approve auth method:",A),alert(`Failed to approve: ${A.message}`)}finally{F(null)}},Ue=async(u,A)=>{if(confirm("Are you sure you want to toggle this authentication method?"))try{F(`toggle-auth-${u}`),await $.admin.toggleAuthMethod(u,!A),h&&await O(h.id)}catch(x){console.error("Failed to toggle auth method:",x),alert(`Failed to toggle auth method: ${x.message}`)}finally{F(null)}},Q=u=>new Date(u).toLocaleString(),Fe=u=>{switch(u){case"passkey":return"ðŸ”";case"password":return"ðŸ”‘";case"oauth2":return"ðŸŒ";case"token":return"ðŸŽŸï¸";default:return"â“"}};return!r||!a?null:t("div",{className:"container",children:[t("div",{className:"admin-header",children:[t("div",{children:[t("h1",{children:"Admin Panel"}),t("p",{children:"Manage users and authentication methods"})]}),t("button",{className:"btn btn-secondary",onClick:()=>L("/dashboard"),children:"â† Back to Dashboard"})]}),t("div",{className:"tabs",children:[t("button",{className:`tab ${s==="users"?"active":""}`,onClick:()=>i("users"),children:["Users (",l.length,")"]}),t("button",{className:`tab ${s==="approvals"?"active":""}`,onClick:()=>i("approvals"),children:["Pending Approvals (",p.length,")"]})]}),U&&t("div",{className:"alert alert-error",children:[U,t("button",{onClick:()=>H(null),children:"âœ•"})]}),s==="users"&&t("div",{className:"admin-content",children:[t("div",{className:"card",children:[t("h3",{children:"Filters"}),t("div",{className:"filters",children:[t("div",{className:"filter-group",children:[t("label",{children:"Search"}),t("input",{type:"text",placeholder:"Search by name, email, nick...",value:f,onChange:u=>C(u.target.value),className:"input"})]}),t("div",{className:"filter-group",children:[t("label",{children:"Status"}),t("select",{value:g===null?"all":String(g),onChange:u=>{const A=u.target.value;k(A==="all"?null:A==="true")},className:"input",children:[t("option",{value:"all",children:"All Users"}),t("option",{value:"true",children:"Enabled Only"}),t("option",{value:"false",children:"Disabled Only"})]})]}),t("div",{className:"filter-group",children:[t("label",{children:"Role"}),t("select",{value:v===null?"all":String(v),onChange:u=>{const A=u.target.value;b(A==="all"?null:A==="true")},className:"input",children:[t("option",{value:"all",children:"All Roles"}),t("option",{value:"true",children:"Admins Only"}),t("option",{value:"false",children:"Users Only"})]})]}),t("button",{onClick:()=>{C(""),k(null),b(null)},className:"btn btn-secondary",children:"Clear Filters"})]})]}),t("div",{className:"card",children:[t("h3",{children:"Users"}),S?t("p",{children:"Loading users..."}):l.length===0?t("p",{children:"No users found matching the filters."}):t("div",{className:"user-table",children:t("table",{children:[t("thead",{children:t("tr",{children:[t("th",{children:"Nick"}),t("th",{children:"Email"}),t("th",{children:"Name"}),t("th",{children:"Role"}),t("th",{children:"Status"}),t("th",{children:"Created"}),t("th",{children:"Actions"})]})}),t("tbody",{children:l.map(u=>t("tr",{className:u.enabled?"":"user-disabled",children:[t("td",{children:[t("strong",{children:u.nick||"â€”"}),u.id===(n==null?void 0:n.id)&&t("span",{className:"badge badge-info",children:"You"})]}),t("td",{children:u.email||"â€”"}),t("td",{children:u.first_name&&u.second_name?`${u.first_name} ${u.second_name}`:"â€”"}),t("td",{children:u.is_admin?t("span",{className:"badge badge-warning",children:"Admin"}):t("span",{className:"badge badge-secondary",children:"User"})}),t("td",{children:u.enabled?t("span",{className:"badge badge-success",children:"Enabled"}):t("span",{className:"badge badge-error",children:"Disabled"})}),t("td",{children:Q(u.created_at)}),t("td",{children:t("div",{className:"action-buttons",children:[t("button",{onClick:()=>O(u.id),className:"btn btn-sm btn-primary",disabled:E==="user-details",children:"Details"}),t("button",{onClick:()=>yn(u.id,u.enabled),className:`btn btn-sm ${u.enabled?"btn-warning":"btn-success"}`,disabled:E===`toggle-user-${u.id}`||u.id===(n==null?void 0:n.id),title:u.id===(n==null?void 0:n.id)?"Cannot toggle your own account":"",children:u.enabled?"Disable":"Enable"})]})})]},u.id))})]})})]}),h&&t("div",{className:"modal-overlay",onClick:()=>o(null),children:t("div",{className:"modal-content",onClick:u=>u.stopPropagation(),children:[t("div",{className:"modal-header",children:[t("h2",{children:"User Details"}),t("button",{className:"modal-close",onClick:()=>o(null),children:"âœ•"})]}),t("div",{className:"modal-body",children:[t("div",{className:"user-details-grid",children:[t("div",{className:"detail-item",children:[t("strong",{children:"ID:"}),t("span",{className:"monospace",children:h.id})]}),t("div",{className:"detail-item",children:[t("strong",{children:"Nick:"}),t("span",{children:h.nick||"â€”"})]}),t("div",{className:"detail-item",children:[t("strong",{children:"Email:"}),t("span",{children:h.email||"â€”"})]}),t("div",{className:"detail-item",children:[t("strong",{children:"Name:"}),t("span",{children:h.first_name&&h.second_name?`${h.first_name} ${h.second_name}`:"â€”"})]}),t("div",{className:"detail-item",children:[t("strong",{children:"Phone:"}),t("span",{children:h.phone_number||"â€”"})]}),t("div",{className:"detail-item",children:[t("strong",{children:"Role:"}),t("span",{children:h.is_admin?"Admin":"User"})]}),t("div",{className:"detail-item",children:[t("strong",{children:"Status:"}),t("span",{children:h.enabled?"Enabled":"Disabled"})]}),t("div",{className:"detail-item",children:[t("strong",{children:"Created:"}),t("span",{children:Q(h.created_at)})]}),t("div",{className:"detail-item",children:[t("strong",{children:"Updated:"}),t("span",{children:Q(h.updated_at)})]})]}),t("h3",{style:{marginTop:"2rem"},children:"Authentication Methods"}),_.length===0?t("p",{children:"No authentication methods found."}):t("div",{className:"auth-methods-list",children:_.map(u=>t("div",{className:"auth-method-item",children:[t("div",{className:"auth-method-header",children:[t("span",{className:"auth-method-icon",children:Fe(u.type)}),t("strong",{children:u.identifier||u.type}),u.enabled?t("span",{className:"badge badge-success",children:"Enabled"}):t("span",{className:"badge badge-error",children:"Disabled"}),u.requires_approval&&!u.approved&&t("span",{className:"badge badge-warning",children:"Pending"})]}),t("div",{className:"auth-method-details",children:[t("small",{children:["Type: ",u.type]}),t("small",{children:["Created: ",Q(u.created_at)]})]}),t("div",{className:"auth-method-actions",children:[u.requires_approval&&!u.approved&&t("button",{onClick:()=>Se(u.id),className:"btn btn-sm btn-success",disabled:E===`approve-${u.id}`,children:"Approve"}),t("button",{onClick:()=>Ue(u.id,u.enabled),className:`btn btn-sm ${u.enabled?"btn-warning":"btn-success"}`,disabled:E===`toggle-auth-${u.id}`,children:u.enabled?"Disable":"Enable"})]})]},u.id))})]})]})})]}),s==="approvals"&&t("div",{className:"admin-content",children:t("div",{className:"card",children:[t("h3",{children:"Pending Authentication Method Approvals"}),S?t("p",{children:"Loading pending approvals..."}):p.length===0?t("p",{children:"No pending approvals."}):t("div",{className:"approvals-list",children:p.map(u=>t("div",{className:"approval-item card",children:[t("div",{className:"approval-header",children:[t("span",{className:"auth-method-icon",children:Fe(u.type)}),t("div",{children:[t("strong",{children:u.identifier||u.type}),t("br",{}),t("small",{className:"text-muted",children:["Type: ",u.type]})]}),t("span",{className:"badge badge-warning",children:"Pending Approval"})]}),t("div",{className:"approval-details",children:[t("p",{children:[t("strong",{children:"User ID:"})," ",t("span",{className:"monospace",children:u.user_id})]}),t("p",{children:[t("strong",{children:"Created:"})," ",Q(u.created_at)]}),t("p",{children:[t("strong",{children:"Enabled:"})," ",u.enabled?"Yes":"No"]})]}),t("div",{className:"approval-actions",children:[t("button",{onClick:()=>Se(u.id),className:"btn btn-success",disabled:E===`approve-${u.id}`,children:E===`approve-${u.id}`?"Approving...":"Approve"}),t("button",{onClick:()=>Ue(u.id,u.enabled),className:"btn btn-error",disabled:E===`toggle-auth-${u.id}`,children:"Disable"})]})]},u.id))})]})}),t("div",{style:{marginTop:"3rem"},children:t(Te,{})})]})}function lt(e){return t("div",{className:"not-found-container",children:t("div",{className:"not-found-content",children:[t("h1",{children:"404"}),t("h2",{children:"Page Not Found"}),t("p",{children:"The page you're looking for doesn't exist."}),t("button",{className:"btn btn-primary",onClick:()=>L("/"),children:"Go Home"})]})})}function ct(){return t(nt,{children:t("div",{id:"app",children:t(fn,{children:[t(tt,{path:"/"}),t(rt,{path:"/login"}),t(at,{path:"/register"}),t(st,{path:"/dashboard"}),t(ot,{path:"/admin"}),t(lt,{default:!0})]})})})}async function dt(){try{const n=await et();n.api_base_url&&Ye(n.api_base_url),console.log("Loaded config:",n)}catch(n){console.warn("Failed to load config, using defaults:",n),Ye("/api")}const e=document.getElementById("app");e&&Pn(t(ct,{}),e)}dt();
